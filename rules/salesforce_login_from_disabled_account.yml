# schema: https://scanner.dev/schema/scanner-detection-rule.v1.json
name: Salesforce Login from Disabled Account
description: |-
  Detect when a disabled account attempts to log into Salesforce.
  An alert is triggered if there are more than ten attempts to
  authenticate to a disabled account.
enabled: true
severity: Medium
query_text: |-
  @scnr.source_type:salesforce
  event_type:Login
  login_status:LOGIN_ERROR_USER_INACTIVE
  | groupbycount(user_name)
  | where @q.count > 10
time_range_s: 300
run_frequency_s: 60
event_sink_keys:
- medium_severity_alerts
tags:
- tactics.ta0006.credential_access
- techniques.t1110.brute_force
- source.salesforce
